<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js" type="text/javascript"></script> 
<script src="../site_media/highcharts.js" type="text/javascript"></script>

<!--
<script src="site_media/chart_example.js" type = "text/javascript"></script>
-->
<div id="chart-container-1" class="highcharts-container" style="width: 100%;
    height: 100% margin: 0 2; clear:both"></div>

<!-- <div id="chart-container-2" class="highcharts-container" style="width: 100%;
    height: 100% margin: 0 2; clear:both"></div> -->
<script type = "text/javascript">

var chart1; // globally available

function load_data()
{
    power_array = [];
    $.get('/power/{{data_list.field}}/{{data_list.field_val}}/data',
        //{'data': JSON.stringify(message) },
        function(data, XMLHttpRequest) {
            data = JSON.parse(data);
            console.log('Received data');
            if(data.length <= 0)
            {
                alert("No data was found for this query");
                return; 
            }
            for(i = 0; i < data.length; i++)
            {
                power_array[i] = data[i].power;
            }
            chart1.series[0].setData(power_array,true);
    
            //setTimeout(load_data, 100000);   
        }
    );
}

$(document).ready(function() {
      chart1 = new Highcharts.Chart({
         chart: {
            renderTo: 'chart-container-1',
            zoomType: 'x',
            defaultSeriesType: 'line',
            events: {
                load: load_data
            }
         },
         title: {
            text: 'Power Measurements for {{data_list.field}} = {{data_list.field_val}} '
         },
         xAxis: {
            //categories: ['Atom1', 'Atom2', 'Atom3']
            title: {
                text: 'Time'
            }
         },
         yAxis: {
            title: {
               text: 'Power'
            }
         },
         series: [{
            name: 'Power',
            pointInterval: 1/8,
            data: [] 
         }
         ]
      });
    })


$("#channel2").click(function() {
    load_data();
      });
              /*
      $("#chart-container-1").animate({
            height: "500 px",
            width: "500 px"
            }, 1000, function() {
                })
                */

                //});

   //});
</script>
